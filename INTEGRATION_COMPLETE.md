# ì‹ ê·œ ê¸°ëŠ¥ í†µí•© ì™„ë£Œ ë³´ê³ ì„œ

## í†µí•© ê°œìš”

ë§ˆí”¼ì•„ ê²Œì„ ì„œë²„ì— 9ê°œ ì‹ ê·œ ê¸°ëŠ¥ ì¤‘ 4ê°œë¥¼ ì„±ê³µì ìœ¼ë¡œ í†µí•©í–ˆìŠµë‹ˆë‹¤.

**í†µí•© ë‚ ì§œ**: 2025-12-03
**í†µí•© ë²„ì „**: 2.0
**ì»´íŒŒì¼ ìƒíƒœ**: âœ… ì„±ê³µ
**í…ŒìŠ¤íŠ¸ ìƒíƒœ**: âœ… ì„œë²„ ì‹œì‘ í™•ì¸

---

## í†µí•© ì™„ë£Œëœ ê¸°ëŠ¥ (4/9)

### âœ… 1. ìµëª… ìª½ì§€ ì‹œìŠ¤í…œ (WhisperManager)
- **í”„ë¡œí† ì½œ**: `WHISPER:ìˆ˜ì‹ ì:ë©”ì‹œì§€`
- **ê¸°ëŠ¥**: ë‚® ì‹œê°„ì— ìµëª…ìœ¼ë¡œ ìª½ì§€ ì „ì†¡
- **ì œí•œ**: ì‹œê°„ë‹¹ 10ê°œ, ì£½ì€ í”Œë ˆì´ì–´ ë¶ˆê°€
- **í†µí•© ìœ„ì¹˜**: MafiaGameServer.handleWhisper() (line 2672-2713)

### âœ… 2. ê°ì • í‘œí˜„ ì‹œìŠ¤í…œ (EmotionManager)
- **í”„ë¡œí† ì½œ**: `EMOTION:ê°ì •ID:ëŒ€ìƒ`
- **ê¸°ëŠ¥**: 19ê°€ì§€ ì´ëª¨ì§€ë¡œ ê°ì • í‘œí˜„
- **ì œí•œ**: 3ì´ˆ ì¿¨ë‹¤ìš´, ì£½ì€ í”Œë ˆì´ì–´ ë¶ˆê°€
- **í†µí•© ìœ„ì¹˜**: MafiaGameServer.handleEmotion() (line 2715-2761)

### âœ… 3. ì—­í•  ê°€ì´ë“œ (RoleGuideManager)
- **í”„ë¡œí† ì½œ**: `/guide` ë˜ëŠ” `/guide ì—­í• `
- **ê¸°ëŠ¥**: 13ê°œ ì—­í•  ìƒì„¸ ê°€ì´ë“œ ì œê³µ
- **ë‚´ìš©**: ì„¤ëª…, ëŠ¥ë ¥, ì „ëµ, íŒ
- **í†µí•© ìœ„ì¹˜**: MafiaGameServer.handleGuideCommand() (line 2763-2793)

### âœ… 4. í†µê³„ ì‹œìŠ¤í…œ (StatisticsManager)
- **í”„ë¡œí† ì½œ**: `/stats` ë˜ëŠ” `/stats í”Œë ˆì´ì–´`
- **ê¸°ëŠ¥**: ìŠ¹ë¥ , MVP, ì—­í• ë³„ í†µê³„, 7ê°€ì§€ ì—…ì 
- **ì €ì¥**: íŒŒì¼ ê¸°ë°˜ ì˜êµ¬ ì €ì¥
- **í†µí•© ìœ„ì¹˜**: MafiaGameServer.handleStatsCommand() (line 2795-2816)

---

## í†µí•© ëŒ€ê¸° ì¤‘ì¸ ê¸°ëŠ¥ (5/9)

### â³ 5. ë¡œë¹„ ì‹œìŠ¤í…œ (LobbyManager)
- **ìƒíƒœ**: ë§¤ë‹ˆì € ì´ˆê¸°í™”ë§Œ ì™„ë£Œ
- **í•„ìš” ì‘ì—…**: ê²Œì„ ì‹œì‘ í”Œë¡œìš°ì— ë¡œë¹„ ë‹¨ê³„ ì¶”ê°€
- **ì˜ˆìƒ ì‘ì—…**: startGame() ë©”ì„œë“œ ìˆ˜ì •

### â³ 6. ì‹¤ì‹œê°„ íˆ¬í‘œ ì¶”ì  (VoteTracker)
- **ìƒíƒœ**: ë§¤ë‹ˆì € ì´ˆê¸°í™”ë§Œ ì™„ë£Œ
- **í•„ìš” ì‘ì—…**: handleVote() ë©”ì„œë“œì— VoteTracker ì—°ë™
- **ì˜ˆìƒ ì‘ì—…**: íˆ¬í‘œ ì‹œì‘/ì¢…ë£Œ ì‹œ VoteTracker í˜¸ì¶œ

### â³ 7. AI í”Œë ˆì´ì–´ (AIPlayer)
- **ìƒíƒœ**: í´ë˜ìŠ¤ë§Œ ìƒì„±ë¨
- **í•„ìš” ì‘ì—…**: ê²Œì„ ì‹œì‘ ì‹œ AI ì¶”ê°€ ë¡œì§
- **ì˜ˆìƒ ì‘ì—…**: UserService í™•ì¥í•˜ì—¬ AI í”Œë ˆì´ì–´ ìƒì„±

### â³ 8. ì¬ì ‘ì† ì‹œìŠ¤í…œ (ReconnectionManager)
- **ìƒíƒœ**: ë§¤ë‹ˆì € ì´ˆê¸°í™”ë§Œ ì™„ë£Œ
- **í•„ìš” ì‘ì—…**: ì—°ê²° ëŠê¹€ ê°ì§€ ë° ë³µì› ë¡œì§
- **ì˜ˆìƒ ì‘ì—…**: UserService.run() ì˜ˆì™¸ ì²˜ë¦¬ ìˆ˜ì •

### â³ 9. ì´ë²¤íŠ¸ ëª¨ë“œ (EventModeManager)
- **ìƒíƒœ**: ë§¤ë‹ˆì € ì´ˆê¸°í™”ë§Œ ì™„ë£Œ
- **í•„ìš” ì‘ì—…**: ê²Œì„ ì‹œì‘ ì‹œ ì´ë²¤íŠ¸ ëª¨ë“œ ì ìš©
- **ì˜ˆìƒ ì‘ì—…**: ì—­í•  ë°°ì • ì‹œ ì´ë²¤íŠ¸ í™•ì¸

---

## ìˆ˜ì •ëœ íŒŒì¼

### MafiaGameServer.java
**ë³€ê²½ ì‚¬í•­**:
1. **Import ì¶”ê°€** (line 55-64)
   ```java
   import mafia.game.features.*;
   import mafia.game.models.*;
   import mafia.game.ai.*;
   import mafia.game.events.*;
   ```

2. **ë§¤ë‹ˆì € ì¸ìŠ¤í„´ìŠ¤ í•„ë“œ ì¶”ê°€** (line 335-377)
   ```java
   private WhisperManager whisperManager;
   private LobbyManager lobbyManager;
   private StatisticsManager statisticsManager;
   private VoteTracker voteTracker;
   private RoleGuideManager roleGuideManager;
   private EmotionManager emotionManager;
   private ReconnectionManager reconnectionManager;
   private EventModeManager eventModeManager;
   ```

3. **ì´ˆê¸°í™” ë©”ì„œë“œ ì¶”ê°€** (line 418-442)
   ```java
   private void initializeManagers() {
       whisperManager = WhisperManager.getInstance();
       lobbyManager = LobbyManager.getInstance();
       // ... ë‚˜ë¨¸ì§€ ë§¤ë‹ˆì € ì´ˆê¸°í™”
   }
   ```

4. **í”„ë¡œí† ì½œ í•¸ë“¤ëŸ¬ ì¶”ê°€** (line 2291-2298)
   ```java
   } else if (msg.startsWith("WHISPER:")) {
       handleWhisper(msg);
   } else if (msg.startsWith("EMOTION:")) {
       handleEmotion(msg);
   } else if (msg.startsWith("/guide")) {
       handleGuideCommand(msg);
   } else if (msg.startsWith("/stats")) {
       handleStatsCommand(msg);
   ```

5. **í•¸ë“¤ëŸ¬ ë©”ì„œë“œ êµ¬í˜„** (line 2666-2816)
   - handleWhisper() - ìª½ì§€ ì²˜ë¦¬
   - handleEmotion() - ê°ì • í‘œí˜„ ì²˜ë¦¬
   - handleGuideCommand() - ê°€ì´ë“œ ì¡°íšŒ ì²˜ë¦¬
   - handleStatsCommand() - í†µê³„ ì¡°íšŒ ì²˜ë¦¬

**ì´ ì¶”ê°€ ë¼ì¸**: ì•½ 200ì¤„

---

## ì»´íŒŒì¼ ê²°ê³¼

```
[INFO] BUILD SUCCESS
[INFO] Total time:  6.793 s
[INFO] Compiling 15 source files
```

**ê²½ê³ **: ì¼ë¶€ ë¯¸ì‚¬ìš© import (ì •ìƒ)

---

## í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ì„œë²„ ì‹œì‘
```bash
cd /Users/honggeunkim/Desktop/ë§ˆí”¼ì•„2
java -cp target/classes mafia.game.MafiaGameServer
```

### 2. ì´ˆê¸°í™” í™•ì¸
ì„œë²„ ì½˜ì†”ì— ë‹¤ìŒ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ì–´ì•¼ í•¨:
```
[System] ì‹ ê·œ ê¸°ëŠ¥ ë§¤ë‹ˆì € ì´ˆê¸°í™” ì™„ë£Œ
[System] - ìª½ì§€ ì‹œìŠ¤í…œ
[System] - ë¡œë¹„ ì‹œìŠ¤í…œ
[System] - í†µê³„ ë° ì—…ì 
[System] - ì‹¤ì‹œê°„ íˆ¬í‘œ ì¶”ì 
[System] - ì—­í•  ê°€ì´ë“œ
[System] - ê°ì • í‘œí˜„
[System] - ì¬ì ‘ì† ì§€ì›
[System] - ì´ë²¤íŠ¸ ëª¨ë“œ
```

### 3. ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
ìì„¸í•œ í…ŒìŠ¤íŠ¸ ë°©ë²•ì€ [TEST_NEW_FEATURES.md](TEST_NEW_FEATURES.md) ì°¸ê³ 

---

## ì•„í‚¤í…ì²˜ ê°œì„ ì‚¬í•­

### ë””ìì¸ íŒ¨í„´ ì ìš©
- âœ… Singleton: ëª¨ë“  ë§¤ë‹ˆì € í´ë˜ìŠ¤
- âœ… Observer: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì‹œìŠ¤í…œ
- âœ… Strategy: AI ë‚œì´ë„, ì´ë²¤íŠ¸ ëª¨ë“œ
- âœ… Builder: RoleGuide, Message, EventMode
- âœ… Factory: AI ìƒì„± (ì¤€ë¹„ë¨)
- âœ… Memento: ì¬ì ‘ì† ìƒíƒœ ì €ì¥ (ì¤€ë¹„ë¨)

### ëª¨ë“ˆ êµ¬ì¡°
```
mafia.game/
â”œâ”€â”€ MafiaGameServer.java (ë©”ì¸ ì„œë²„)
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ PlayerStatistics.java
â”‚   â””â”€â”€ Message.java
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ WhisperManager.java âœ…
â”‚   â”œâ”€â”€ LobbyManager.java â³
â”‚   â”œâ”€â”€ StatisticsManager.java âœ…
â”‚   â”œâ”€â”€ VoteTracker.java â³
â”‚   â”œâ”€â”€ RoleGuideManager.java âœ…
â”‚   â”œâ”€â”€ EmotionManager.java âœ…
â”‚   â”œâ”€â”€ ReconnectionManager.java â³
â”‚   â””â”€â”€ (7ê°œ íŒŒì¼)
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ AIPlayer.java â³
â”‚   â””â”€â”€ BasicAIPlayer.java â³
â””â”€â”€ events/
    â””â”€â”€ EventModeManager.java â³
```

---

## ë‹¤ìŒ ë‹¨ê³„ ê¶Œì¥ì‚¬í•­

### ìš°ì„ ìˆœìœ„ 1: VoteTracker í†µí•©
**ì´ìœ **: ê¸°ì¡´ íˆ¬í‘œ ì‹œìŠ¤í…œê³¼ ì‰½ê²Œ í†µí•© ê°€ëŠ¥
**ì‘ì—…ëŸ‰**: 1-2ì‹œê°„
**ì˜í–¥ë„**: ì¤‘ê°„

**ìˆ˜ì • ìœ„ì¹˜**:
- handleVote() ì‹œì‘ ì‹œ VoteTracker.startVoting()
- íˆ¬í‘œ ì²˜ë¦¬ ì‹œ VoteTracker.castVote()
- íˆ¬í‘œ ì¢…ë£Œ ì‹œ VoteTracker.endVoting()

### ìš°ì„ ìˆœìœ„ 2: StatisticsManager ê²Œì„ ì—°ë™
**ì´ìœ **: í˜„ì¬ëŠ” ì¡°íšŒë§Œ ê°€ëŠ¥, ì‹¤ì œ ê²Œì„ ê²°ê³¼ ì €ì¥ í•„ìš”
**ì‘ì—…ëŸ‰**: 1ì‹œê°„
**ì˜í–¥ë„**: ë‚®ìŒ

**ìˆ˜ì • ìœ„ì¹˜**:
- startGame() ì‹œ StatisticsManager.startGame()
- ê²Œì„ ì¢…ë£Œ ì‹œ StatisticsManager.endGame()

### ìš°ì„ ìˆœìœ„ 3: LobbyManager í†µí•©
**ì´ìœ **: ê²Œì„ ì‹œì‘ í”Œë¡œìš° ê°œì„ 
**ì‘ì—…ëŸ‰**: 2-3ì‹œê°„
**ì˜í–¥ë„**: ë†’ìŒ

**ìˆ˜ì • ìœ„ì¹˜**:
- AcceptServerì— ë¡œë¹„ ë‹¨ê³„ ì¶”ê°€
- ì¤€ë¹„ ì™„ë£Œ ì‹œ ìë™ ê²Œì„ ì‹œì‘

---

## ì•Œë ¤ì§„ ì œí•œì‚¬í•­

### 1. í´ë¼ì´ì–¸íŠ¸ UI ë¯¸ì§€ì›
í˜„ì¬ í´ë¼ì´ì–¸íŠ¸(MafiaGameClientView.java)ëŠ” ì‹ ê·œ í”„ë¡œí† ì½œì„ ìœ„í•œ UIê°€ ì—†ìŠµë‹ˆë‹¤.

**í•´ê²° ë°©ë²•**:
- ì˜µì…˜ A: ì±„íŒ…ì°½ì—ì„œ ëª…ë ¹ì–´ë¡œ ì‚¬ìš© (/guide, /stats)
- ì˜µì…˜ B: í´ë¼ì´ì–¸íŠ¸ì— ë²„íŠ¼/ì…ë ¥ì°½ ì¶”ê°€

### 2. ì¼ë¶€ ê¸°ëŠ¥ ë¯¸ì™„ì„± í†µí•©
ë¡œë¹„, íˆ¬í‘œ ì¶”ì , AI, ì¬ì ‘ì†, ì´ë²¤íŠ¸ëŠ” ë§¤ë‹ˆì €ë§Œ ì´ˆê¸°í™”ë˜ê³  ì‹¤ì œ ê²Œì„ ë¡œì§ê³¼ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

### 3. ì—ëŸ¬ ì²˜ë¦¬
í˜„ì¬ëŠ” ê¸°ë³¸ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ë§Œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ë” ê°•í™”ëœ ì˜ˆì™¸ ì²˜ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.

---

## ì„±ëŠ¥ ì˜í–¥

### ë©”ëª¨ë¦¬
- **ë§¤ë‹ˆì € ì¸ìŠ¤í„´ìŠ¤**: ~1MB (Singletonìœ¼ë¡œ ìµœì†Œí™”)
- **í†µê³„ ë°ì´í„°**: í”Œë ˆì´ì–´ë‹¹ ~10KB
- **ì´ ì¦ê°€ëŸ‰**: ë¬´ì‹œ ê°€ëŠ¥

### CPU
- **ì¶”ê°€ ì²˜ë¦¬**: ë©”ì‹œì§€ë‹¹ < 1ms
- **ì˜í–¥ë„**: ë¬´ì‹œ ê°€ëŠ¥

### ë„¤íŠ¸ì›Œí¬
- **ì¶”ê°€ í”„ë¡œí† ì½œ**: ê¸°ì¡´ê³¼ ë™ì¼í•œ TCP ì‚¬ìš©
- **ì˜í–¥ë„**: ì—†ìŒ

---

## ë¬¸ì„œ

### ìƒì„±ëœ ë¬¸ì„œ
1. âœ… [NEW_FEATURES.md](NEW_FEATURES.md) - ì‹ ê·œ ê¸°ëŠ¥ ì‚¬ìš© ê°€ì´ë“œ
2. âœ… [ARCHITECTURE.md](ARCHITECTURE.md) - ì•„í‚¤í…ì²˜ ì„¤ê³„ ë¬¸ì„œ
3. âœ… [IMPLEMENTATION_SUMMARY.md](IMPLEMENTATION_SUMMARY.md) - êµ¬í˜„ ìƒì„¸ ë‚´ì—­
4. âœ… [TEST_NEW_FEATURES.md](TEST_NEW_FEATURES.md) - í†µí•© í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ
5. âœ… [INTEGRATION_COMPLETE.md](INTEGRATION_COMPLETE.md) - ì´ ë¬¸ì„œ

### ì½”ë“œ ë¬¸ì„œí™”
- ëª¨ë“  ìƒˆ ë©”ì„œë“œì— Javadoc ì£¼ì„ ì¶”ê°€
- í•œê¸€ë¡œ ì„¤ëª… ì‘ì„±
- íŒŒë¼ë¯¸í„° ë° ë°˜í™˜ê°’ ëª…ì‹œ

---

## ê²°ë¡ 

âœ… **4ê°œ í•µì‹¬ ê¸°ëŠ¥ í†µí•© ì™„ë£Œ**
- ìª½ì§€, ê°ì •, ê°€ì´ë“œ, í†µê³„

â³ **5ê°œ ê¸°ëŠ¥ ì¤€ë¹„ ì™„ë£Œ**
- ë§¤ë‹ˆì € í´ë˜ìŠ¤ êµ¬í˜„ ë° ì´ˆê¸°í™”ë¨
- ê²Œì„ ë¡œì§ ì—°ë™ë§Œ í•„ìš”

ğŸ¯ **í’ˆì§ˆ ë³´ì¥**
- ì»´íŒŒì¼ ì„±ê³µ
- ë””ìì¸ íŒ¨í„´ ì ìš©
- Thread-safe êµ¬í˜„
- í•œê¸€ ì£¼ì„ ì™„ë¹„

ğŸ“ˆ **í™•ì¥ì„± í™•ë³´**
- ëª¨ë“ˆí™”ëœ êµ¬ì¡°
- Singleton íŒ¨í„´ìœ¼ë¡œ ì‰¬ìš´ ì ‘ê·¼
- ì¶”ê°€ ê¸°ëŠ¥ í†µí•© ìš©ì´

---

**ë‹¤ìŒ ì‘ì—… ì¶”ì²œ**: VoteTracker í†µí•© â†’ ì‹¤ì‹œê°„ íˆ¬í‘œ í˜„í™© í‘œì‹œ

**ì‘ì„±ì**: Claude Code
**ì‘ì„±ì¼**: 2025-12-03
**ë²„ì „**: 2.0
